- defaults:
    link:
      create: true
      relink: true
      force: true
- clean:
    - "~"
- link:
    ~/.profile:
    ~/.bashrc:
    ~/.zshrc:
    ~/.p10k.zsh:
    ~/.gitconfig:
    ~/.sdkman/etc/config: sdkman/etc/config
- create:
    - ~/repos
    - ~/bin
    - ~/.local/bin
- shell:
    - command: git submodule update --init --recursive
      description: Installing submodules
    - command: echo "$USER  ALL=(ALL) NOPASSWD:ALL" | sudo tee "/etc/sudoers.d/$USER"
      description: Adding user to sudoers
    - command: sudo apt update && sudo apt install zsh -y
      description: Installing zsh
    - command: rm -rf "$HOME/.antigen"; git clone https://github.com/zsh-users/antigen.git "$HOME/.antigen"
      description: Installing antigen
    - command: sudo chsh -s $(which zsh) "$USER"
      description: Making zsh the default shell
    - command: sudo apt install build-essential curl file -y
      description: Installing Homebrew dependencies
    - command: bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"
      description: Installing Homebrew
    - command: zsh -c "source \"$HOME/.zshrc\""
      description: Sourcing zshrc
    - command: bash -lc 'brew install gh shellcheck jq'
      description: Installing gh, shellcheck, jq
    - if:
      command: |
        set -e
        if [ -n "$WSL_DISTRO_NAME" ] || [ -n "$IS_WSL" ]; then
          USERPROFILE="$(wslpath "$(wslvar USERPROFILE)")"
          if [ -f "$USERPROFILE/.ssh/id_rsa" ]; then
            cp -rf "$USERPROFILE/.ssh/." "$HOME/.ssh"
            chmod 600 "$HOME/.ssh/id_rsa"
          fi
        fi
      description: Syncing ~/.ssh folder
    - command: bash -c "$(curl -fsSL "https://get.sdkman.io?rcupdate=false")" && bash -lc 'sdk selfupdate force'
      description: Installing SDKMAN!
    - command: bash -lc "sdk i java "$(sdk ls java | grep -o '8.*.hs-adpt' | awk '{print $NF}')"" | grep "already installed"
      description: Installing latest AdoptOpenJDK 8 Hotspot
